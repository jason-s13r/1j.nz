<!DOCTYPE html>
<html lang="en-us">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>qif2json.ts  - Jason Schwarzenberger</title>
<meta name="description" content="Software engineer from New Zealand.">

<link rel="icon" type="image/x-icon" href="https://jason.schwarzenberger.nz/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="https://jason.schwarzenberger.nz/favicon.png">

<link rel="stylesheet" href="https://jason.schwarzenberger.nz/css/style.css?rnd=1591147581" />

<link rel="stylesheet" href="https://jason.schwarzenberger.nz/css/my.css?rnd=1591147581">

<meta property="og:title" content="qif2json.ts" />
<meta property="og:description" content="gist link
This is qif2json.ts is a minor refactor to bring Typescript support to the qif2json package available on NPM. It is the basic QIF parsing without any other requirements from Node (fs) or NPM (iconv, jschardet). This means that it is possible to do the QIF parsing in the browser.
   Attachment Type Size     qif2json.ts video/MP2T 3.9KiB   readme.md text/markdown 594.0B     qif2json." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jason.schwarzenberger.nz/posts/gist/2019-02-12/04805514b1fc07310000e8c770b6486c/" />
<meta property="og:image" content="https://jason.schwarzenberger.nz/images/Schwarzenberger.png"/>
<meta property="article:published_time" content="2019-02-12T21:26:33+00:00" />
<meta property="article:modified_time" content="2019-02-12T21:26:33+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://jason.schwarzenberger.nz/images/Schwarzenberger.png"/>

<meta name="twitter:title" content="qif2json.ts"/>
<meta name="twitter:description" content="gist link
This is qif2json.ts is a minor refactor to bring Typescript support to the qif2json package available on NPM. It is the basic QIF parsing without any other requirements from Node (fs) or NPM (iconv, jschardet). This means that it is possible to do the QIF parsing in the browser.
   Attachment Type Size     qif2json.ts video/MP2T 3.9KiB   readme.md text/markdown 594.0B     qif2json."/>






    
</head>
<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header> 
            
                <div class="site-header">
    <a class="site-logo" href="/">
        <img src="/images/Schwarzenberger.png" alt="logo" />
    </a>

    <h1>
        <a href="/">Jason Schwarzenberger</a>
    </h1>
    <div>Software engineer from New Zealand.</div>
</div>
<nav>
    
    
    <a class=""
        href="https://jason.schwarzenberger.nz/posts/" title="Archive">Archive</a>
    
    <a class=""
        href="https://jason.schwarzenberger.nz/tags/" title="Tags">Tags</a>
    
</nav>
            
        </header>
        <main id="main" tabindex="-1"> 
            

    <article class="post">
        <header>
            <h1>qif2json.ts</h1>
        </header>
        <div class="content">
            <p><a href="https://gist.github.com/04805514b1fc07310000e8c770b6486c">gist link</a></p>
<p>This is qif2json.ts is a minor refactor to bring Typescript support to the qif2json package available on NPM. It is the basic QIF parsing without any other requirements from Node (fs) or NPM (iconv, jschardet). This means that it is possible to do the QIF parsing in the browser.</p>
<table>
<thead>
<tr>
<th>Attachment</th>
<th>Type</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://gist.githubusercontent.com/master5o1/04805514b1fc07310000e8c770b6486c/raw/cbf3caa12362720b00f305ac89bdee08059c5243/qif2json.ts">qif2json.ts</a></td>
<td>video/MP2T</td>
<td>3.9KiB</td>
</tr>
<tr>
<td><a href="https://gist.githubusercontent.com/master5o1/04805514b1fc07310000e8c770b6486c/raw/998e15c4d37a39cd142af8e6bbbc7de1249602bd/readme.md">readme.md</a></td>
<td>text/markdown</td>
<td>594.0B</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="qif2jsontshttpsgistgithubusercontentcommaster5o104805514b1fc07310000e8c770b6486crawcbf3caa12362720b00f305ac89bdee08059c5243qif2jsonts----videomp2t-39kib"><a href="https://gist.githubusercontent.com/master5o1/04805514b1fc07310000e8c770b6486c/raw/cbf3caa12362720b00f305ac89bdee08059c5243/qif2json.ts">qif2json.ts</a> &ndash; video/MP2T, 3.9KiB</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#75715e">/* Adapted by Jason Schwarzenberger
</span><span style="color:#75715e"> * for Typescript from
</span><span style="color:#75715e"> * qif2json
</span><span style="color:#75715e"> * https://github.com/spmason/qif2json
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * Copyright (c) 2012 Steve Mason
</span><span style="color:#75715e"> * Licensed under the MIT license.
</span><span style="color:#75715e"> */</span>

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">parseDate</span>(<span style="color:#a6e22e">str</span>: <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">format</span>: <span style="color:#66d9ef">string</span>) {
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">day</span>, <span style="color:#a6e22e">month</span>, <span style="color:#a6e22e">year</span>]<span style="color:#f92672">:</span> <span style="color:#a6e22e">any</span>[] <span style="color:#f92672">=</span> <span style="color:#a6e22e">str</span>.<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>).<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">/[^0-9]/</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">output</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">year</span>: <span style="color:#66d9ef">number</span>;
    <span style="color:#a6e22e">month</span>: <span style="color:#66d9ef">string</span>;
    <span style="color:#a6e22e">day</span>: <span style="color:#66d9ef">string</span>;
  } <span style="color:#f92672">=</span> { <span style="color:#a6e22e">year</span>: <span style="color:#66d9ef">0</span>, <span style="color:#a6e22e">month</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;00&#39;</span>, <span style="color:#a6e22e">day</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;00&#39;</span> };
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">yearNow</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">getFullYear</span>();
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">yearInt</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">year</span>, <span style="color:#ae81ff">10</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">year1900</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1900</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">yearInt</span>;
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">year2000</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">2000</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">yearInt</span>;

  <span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">day</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">day</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">`0</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">day</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">day</span>;
  <span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">month</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">month</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">`0</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">month</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">day</span>;
  <span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">year</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">year</span>;

  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">year</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">2</span>) {
    <span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">year</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">year2000</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">yearNow</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">year1900</span> : <span style="color:#66d9ef">year2000</span>;
  }

  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">format</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;us&#39;</span>) {
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">year</span><span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">day</span><span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">month</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
  }
  <span style="color:#66d9ef">return</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">year</span><span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">month</span><span style="color:#e6db74">}</span><span style="color:#e6db74">-</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">output</span>.<span style="color:#a6e22e">day</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">QifOptions</span> {
  <span style="color:#a6e22e">dateFormat?</span>: <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">ignoreType?</span>: <span style="color:#66d9ef">boolean</span>;
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Qif</span> {
  <span style="color:#a6e22e">transactions</span>: <span style="color:#66d9ef">Transaction</span>[];
  <span style="color:#a6e22e">type</span>: <span style="color:#66d9ef">string</span>;
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Division</span> {
  <span style="color:#a6e22e">amount</span>: <span style="color:#66d9ef">number</span>;
  <span style="color:#a6e22e">category</span>: <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">description</span>: <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">subcategory</span>: <span style="color:#66d9ef">string</span>;
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Transaction</span> {
  <span style="color:#a6e22e">date</span>: <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">amount</span>: <span style="color:#66d9ef">number</span>;
  <span style="color:#66d9ef">number</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">memo</span>: <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">address</span>: <span style="color:#66d9ef">string</span>[];
  <span style="color:#a6e22e">payee</span>: <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">category</span>: <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">subcategory</span>: <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">clearedStatus</span>: <span style="color:#66d9ef">string</span>;
  <span style="color:#a6e22e">division</span>: <span style="color:#66d9ef">Division</span>[];
  [<span style="color:#a6e22e">key</span>: <span style="color:#66d9ef">string</span>]<span style="color:#f92672">:</span> <span style="color:#a6e22e">any</span>;
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parser</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">qif</span>: <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">options</span>: <span style="color:#66d9ef">QifOptions</span> <span style="color:#f92672">=</span> &lt;<span style="color:#f92672">QifOptions</span>&gt;{ <span style="color:#a6e22e">ignoreType</span>: <span style="color:#66d9ef">false</span> })<span style="color:#f92672">:</span> <span style="color:#a6e22e">Qif</span> <span style="color:#f92672">=&gt;</span> {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">lines</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">qif</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#39;\n&#39;</span>);
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">line</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">lines</span>.<span style="color:#a6e22e">shift</span>();
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">transaction</span>: <span style="color:#66d9ef">Transaction</span> <span style="color:#f92672">=</span> &lt;<span style="color:#f92672">Transaction</span>&gt;{};
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">division</span>: <span style="color:#66d9ef">Division</span> <span style="color:#f92672">=</span> &lt;<span style="color:#f92672">Division</span>&gt;{};
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">typeArray</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">/!Type:([^$]*)$/</span>.<span style="color:#a6e22e">exec</span>(<span style="color:#a6e22e">line</span><span style="color:#f92672">!</span>.<span style="color:#a6e22e">trim</span>()) <span style="color:#f92672">||</span> [];

  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">typeArray</span> <span style="color:#f92672">||</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">typeArray</span>.<span style="color:#a6e22e">length</span>) {
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">ignoreType</span>) {
      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;File does not appear to be a valid qif file: &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">line</span>);
    }
    <span style="color:#a6e22e">typeArray</span>[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">line</span><span style="color:#f92672">!</span>.<span style="color:#a6e22e">trim</span>();
  }

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">type</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">typeArray</span>[<span style="color:#ae81ff">1</span>];
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">transactions</span>: <span style="color:#66d9ef">Transaction</span>[] <span style="color:#f92672">=</span> [];

  <span style="color:#75715e">// tslint:disable-next-line: no-conditional-assignment
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">while</span> ((<span style="color:#a6e22e">line</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">lines</span>.<span style="color:#a6e22e">shift</span>())) {
    <span style="color:#a6e22e">line</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">trim</span>();
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">line</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;^&#39;</span>) {
      <span style="color:#a6e22e">transactions</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">transaction</span>);
      <span style="color:#a6e22e">transaction</span> <span style="color:#f92672">=</span> &lt;<span style="color:#f92672">Transaction</span>&gt;{};
      <span style="color:#66d9ef">continue</span>;
    }
    <span style="color:#66d9ef">switch</span> (<span style="color:#a6e22e">line</span>[<span style="color:#ae81ff">0</span>]) {
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;D&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">date</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parseDate</span>(<span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>), <span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">dateFormat</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;&#39;</span>);
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;T&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">amount</span> <span style="color:#f92672">=</span> parseFloat(<span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">&#39;,&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>));
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;N&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#a6e22e">transaction</span>.<span style="color:#66d9ef">number</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>);
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;M&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">memo</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>);
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;A&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">address</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">address</span> <span style="color:#f92672">||</span> []).<span style="color:#a6e22e">concat</span>(<span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>));
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;P&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">payee</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/&amp;amp;/g</span>, <span style="color:#e6db74">&#39;&amp;&#39;</span>);
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;L&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">lArray</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#39;:&#39;</span>);
        <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">category</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">lArray</span>[<span style="color:#ae81ff">0</span>];
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">lArray</span>[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">!==</span> <span style="color:#66d9ef">undefined</span>) {
          <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">subcategory</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">lArray</span>[<span style="color:#ae81ff">1</span>];
        }
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;C&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">clearedStatus</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>);
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;S&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sArray</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#39;:&#39;</span>);
        <span style="color:#a6e22e">division</span>.<span style="color:#a6e22e">category</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sArray</span>[<span style="color:#ae81ff">0</span>];
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">sArray</span>[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">!==</span> <span style="color:#66d9ef">undefined</span>) {
          <span style="color:#a6e22e">division</span>.<span style="color:#a6e22e">subcategory</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sArray</span>[<span style="color:#ae81ff">1</span>];
        }
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;E&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#a6e22e">division</span>.<span style="color:#a6e22e">description</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>);
        <span style="color:#66d9ef">break</span>;
      <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;$&#39;</span><span style="color:#f92672">:</span>
        <span style="color:#a6e22e">division</span>.<span style="color:#a6e22e">amount</span> <span style="color:#f92672">=</span> parseFloat(<span style="color:#a6e22e">line</span>.<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>));
        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>(<span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">division</span> <span style="color:#66d9ef">instanceof</span> Array)) {
          <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">division</span> <span style="color:#f92672">=</span> [];
        }
        <span style="color:#a6e22e">transaction</span>.<span style="color:#a6e22e">division</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">division</span>);
        <span style="color:#a6e22e">division</span> <span style="color:#f92672">=</span> &lt;<span style="color:#f92672">Division</span>&gt;{};

        <span style="color:#66d9ef">break</span>;

      <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;Unknown Detail Code: &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">line</span>[<span style="color:#ae81ff">0</span>]);
    }
  }

  <span style="color:#66d9ef">if</span> (Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">transaction</span>).<span style="color:#a6e22e">length</span>) {
    <span style="color:#a6e22e">transactions</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">transaction</span>);
  }

  <span style="color:#66d9ef">return</span> &lt;<span style="color:#f92672">Qif</span>&gt;{
    <span style="color:#a6e22e">transactions</span>,
    <span style="color:#a6e22e">type</span>
  };
};

</code></pre></div><hr>
<h3 id="readmemdhttpsgistgithubusercontentcommaster5o104805514b1fc07310000e8c770b6486craw998e15c4d37a39cd142af8e6bbbc7de1249602bdreadmemd----textmarkdown-5940b"><a href="https://gist.githubusercontent.com/master5o1/04805514b1fc07310000e8c770b6486c/raw/998e15c4d37a39cd142af8e6bbbc7de1249602bd/readme.md">readme.md</a> &ndash; text/markdown, 594.0B</h3>
<p>This is qif2json.ts is a minor refactor to bring Typescript support to the <a href="https://github.com/spmason/qif2json">qif2json</a> package available on NPM. It is the basic QIF parsing without any other requirements from Node (fs) or NPM (iconv, jschardet). This means that it is possible to do the QIF parsing in the browser.</p>
<p>I&rsquo;ve written my own <a href="https://stackblitz.com/edit/typescript-5qwgx1?file=qif.ts">QIF parser</a> on StackBlitz which is an improvement in terms of QIF support. Perhaps not as great performance, meh. Can see what it does using this <a href="https://typescript-5qwgx1.stackblitz.io">demo</a>.</p>

        </div>
        

    


<div class="article-info">
    
        <div class="article-date">2019-02-12 21:26</div>
    
    <div class="article-taxonomies">
        
            
                <ul class="article-tags">
                    
                        <li><a href="https://jason.schwarzenberger.nz/tags/gist">#gist</a></li>
                    
                </ul>
        
    </div>
</div>

    </article>
    


        </main>
        <footer>
            
                
                

                
            
        </footer>
    </div>
</body>
</html>
